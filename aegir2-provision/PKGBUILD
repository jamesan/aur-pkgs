# Maintainer: James An <james@jamesan.ca>
pkgname=('aegir2-provision')
pkgver=2.1
pkgrel=1
pkgdesc="Meta-Drupal hosting system - back end"
arch=('any')
url="http://aegirproject.org/"
license=('GPL')
depends=('apache' 'drush>=5.10' 'mysql-clients' 'php' 'php-apache' 'sudo' 'smtp-forwarder')
optdepends=('rsync: asdf'
            'mysql: ')
options=(!strip docs)
install="${pkgname}.install"
source=("aegir" "http://debian.aegirproject.org/pool/main/a/${pkgname}/${pkgname}_${pkgver}_all.deb")
md5sums=('ae0aba34975ba9c2615f8748ab070580'
         '1a8575b89edc7dfd14ddacb4aa2e1ee0')

package() {
    msg2 "Extracting data.tar.xz"
    bsdtar -xf data.tar.xz -C "$pkgdir/"

    msg2 "Removing files that won't work"
    rm -R "$pkgdir"/usr/share/lintian

    msg2 "Adding aegir sudoers policy"
    mkdir -pm=750 "$pkgdir"/etc/sudoers.d
    install -m440 aegir "$pkgdir"/etc/sudoers.d
}
